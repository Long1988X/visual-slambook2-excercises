[toc]

# 第11讲 回环检测

## 1. 目标

	1. 理解回环检测的必要性。
	2. 掌握基于词袋的外观式回环检测。
	3. 通过DBoW3的实验，学习词袋模型的实际用途。

## 2. 知识点

1. 回环检测的意义：

   > 1. 关系到估计的轨迹和地图在长时间下的正确性；
   > 2. 可以利用回环检测进行重定位；

2. 回环检测的方法：

   > 1. 最简单的方式：对任意两幅图像都做一遍特征匹配；
   > 2. 另一种朴素方法：随机抽取历史数据并进行回环检测；
   > 3. 基于外观的，仅根据**两幅图像的相似性**确定回环检测关系；
   > 4. **词袋，Bag-of-Words**，目的是用“图像上有哪几种特征”来描述一幅图像；
   > 5. **字典**，由很多单词组成，聚类问题；
   > 6. 相似度计算；

3. 回环检测的步骤：

   > 检测到回环的发生
   >
   > 计算回环修选帧与当前帧的运动
   >
   > 验证回环是否成立
   >
   > 闭环

4. 回环检测的指标：

   > 1. 准确率：所有回环中确实是真实回环的概率；
   > 2. 召回率：所有真实回环中被正确检测出来的概率；

## 3. 实践

1. 创建字典
2. 相似度的计算

## 4. 课后习题

1. 请书写计算PR曲线的小程序。用MATLAB或Python可能更简便，因为它们擅长作图。

2. 验证回环检测算法，需要有人工标记回环的数据集，例如参考文献[103]。然而人工标记回环是很不方便的，我们会考虑根据标准轨迹计算回环。

   即，如果轨迹中有两个帧的位姿非常相近，就认为它们是回环。请根据TUM数据集给出的标准轨迹，计算出一个数据集中的回环。

   这些回环的图像真的相似吗？

3. 学习DBoW3或DBoW2库，自己寻找几张图片，看能否从中正确检测出回环。

4. 调研相似性评分的常用度量方式，哪些比较常用？

   问题定义：有两个对象X,Y,都包含N维特征，X=(x1,x2,x3,……..,xn),Y=(y1,y2,y3,……..,yn),计算X和Y的相似性。常用的有五种方法，如下：
   
   1. 欧几里得距离（Eucledian Distance）
   
   2. 曼哈顿距离（Manhattan Distance）
   
   3. 明可夫斯基距离（Minkowski distance）
   
   4. Cosine Similarity（余弦相似度）
   
   5. Jaccard Similarity
   
5. Chow-Liu树是什么原理？它是如何被用于构建字典和回环检测的？

6. 阅读参考文献[118]，除了词袋模型，还有哪些用于回环检测的方法？

   [118] A comparison of loop closing techniques in monocular SLAM - 2009

   **Loop closure detection systems** for monocular SLAM come in three broad categories:

    **(i) map-to-map, (ii) image-to-image and (iii) image-to-map**

